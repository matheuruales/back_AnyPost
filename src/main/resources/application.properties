spring.config.import=optional:file:.env[.properties]

# Bind to the port provided by Railway/Render/etc. (defaults to 8080 locally)
server.port=${PORT:8080}

# Database (defaults to in-memory H2 when no external variables are provided)
spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:h2:mem:anypost;MODE=PostgreSQL;DATABASE_TO_LOWER=TRUE;DEFAULT_NULL_ORDERING=HIGH;DB_CLOSE_DELAY=-1}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:sa}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:}


# Connection pool settings for reliability (HikariCP)
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.connection-test-query=SELECT 1

# JPA / Hibernate settings
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=update
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.jdbc.time_zone=UTC
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true

# CORS configuration
app.cors.allowed-origins=${CORS_ALLOWED_ORIGINS:*}
app.cors.allow-credentials=${CORS_ALLOW_CREDENTIALS:true}

# External webhook configuration
n8n.webhook.url=${N8N_WEBHOOK_URL}

# Blotato video generation
blotato.api.key=${BLOTATO_API_KEY}
blotato.api.base-url=${BLOTATO_API_BASE_URL}
blotato.api.template-id=${BLOTATO_API_TEMPLATE_ID}

# Azure Blob Storage
azure.blob.connection-string=${AZURE_BLOB_CONNECTION_STRING}
azure.blob.container-name=${AZURE_BLOB_CONTAINER}

# OpenAI image generation
openai.api.key=${OPENAI_API_KEY}
openai.api.base-url=${OPENAI_API_BASE_URL:https://api.openai.com/v1}
openai.images.model=${OPENAI_IMAGE_MODEL:dall-e-3}